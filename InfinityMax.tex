
% !TEX root =  main.tex



\subsection{Well-Behaved Trees}
\label{subsec:infinity}

\begin{code}[hide]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≤\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Iso}\<%
\\
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{InfinityMax}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaBound{ℂ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaBound{ℓ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{El}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaBound{ℓ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{Cℕ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Iso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{El}\AgdaSpace{}%
\AgdaBound{Cℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{default}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{El}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Brouwer}\AgdaSpace{}%
\AgdaBound{ℂ}\AgdaSpace{}%
\AgdaBound{El}\AgdaSpace{}%
\AgdaBound{Cℕ}\AgdaSpace{}%
\AgdaBound{CℕIso}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{IndMax}\AgdaSpace{}%
\AgdaBound{ℂ}\AgdaSpace{}%
\AgdaBound{El}\AgdaSpace{}%
\AgdaBound{Cℕ}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{default}\<%
\\
%
\>[2]\AgdaKeyword{opaque}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{unfolding}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaFunction{indMax'}\<%
\end{code}

Our first step in defining an ordinal notation with a well behaved maximum
is to identify a class of Brouwer trees which are well behaved with
respect to the inductive maximum.
As we saw in

The answer, it turns out, is more limits:
if we $\indMax$ a term with itself an infinite number of times,
the result will be idempotent with respect to $\indMax$.
First, we define a function to $\indMax$ a term with itself $n$
times or a given number $n$:
\begin{code}%
%
\>[4]\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[4]\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaInductiveConstructor{ℕ.zero}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Z}\<%
\\
%
\>[4]\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\<%
\end{code}

To compute
a tree equivalent to the infinite
chain of applications $\indMax\ t\ (\indMax\ t\ (\indMax\ t\ \ldots))$,
we take the limit of $n$ applications over all $n$:
\begin{code}%
%
\>[4]\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[4]\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[17]\AgdaFunction{ℕLim}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\end{code}

This operator has useful basic properties: it is monotone, and it computes
an upper bound on is argument.

\begin{code}%
%
\>[4]\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-mono}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t2}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\end{code}

    However, the most important property we want from $\maxInf$ is that $\indMax$ is idempotent
    with respect to it.
  The first step to showing this is realizing that we can take the maximum of $t$
  and $\maxInf\ t$ and we have a tree that is no larger than $\maxInf\ t$:
  because it is already an infinite chain of applications, adding one more
  makes no difference.
%
\begin{code}%
%
\>[4]\AgdaFunction{indMax-∞lt1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax-∞lt1}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{≤-limiting}%
\>[32]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.fun}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{where}\<%
\\
%
\>[8]\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[8]\AgdaFunction{helper}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaInductiveConstructor{≤-cocone}%
\>[20]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.inv}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{sn}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{sn}\AgdaSymbol{)}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.rightInv}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)))}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{≤-refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\<%
\end{code}
%
      If adding one more $\indMax\ t$ has no effect, then adding $n$ more will also have no effect:
\begin{code}%
%
\>[4]\AgdaFunction{indMax-∞ltn}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax-∞ltn}\AgdaSpace{}%
\AgdaInductiveConstructor{ℕ.zero}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax-≤Z}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{indMax-∞ltn}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{indMax-monoR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-commut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax-assocL}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax-monoL}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-∞lt1}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax-∞ltn}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{t}\<%
\end{code}
%
      By our inductive definition of $\indMax$, we have that
      \begin{displaymath}
      \indMax\ (\maxInf\ t) (\maxInf\ t)
    \end{displaymath}
    is equal to
    \begin{displaymath}
      \nLim\ (\lambda n \to \indMax\ (\AgdaFunction{nIndMax}\ n\ t)\ (\maxInf\ t) )
    \end{displaymath}
    Our previous lemma gives that, for any $n$, $\maxInf\ t$ is an upper bound for $\indMax\ (\AgdaFunction{nIndMax}\ n\ t)\ (\maxInf\ t) )$.
      So $\limiting$ gives that the limit over all $n$ is also bounded by $\maxInf\ t$, \ie $\Lim$ constructs the least of all upper bounds.
      This gives us our key result: up to $\le$, $\indMax$ is idempotent on values constructed with $\maxInf$.
      \begin{code}%
%
\>[4]\AgdaFunction{indMax∞-idem}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-idem}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaInductiveConstructor{≤-limiting}%
\>[18]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}\AgdaFunction{indMax-commut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.fun}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax-∞ltn}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.fun}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\<%
\end{code}

    There is one last property to prove that will be useful in the next section:
    $\maxInf\ t$  is a lower bound on $t$, and hence equivalent to it,
    whenever $\indMax$ is idempotent on $t$.
    If taking $\indMax$ of $t$ with itself does not increase it size, doing so $n$
    times will not increase it size, so again the result follows from $\Lim$ being
    the least upper bound.
   \begin{code}%
%
\>[4]\AgdaFunction{indMax∞-≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-≤}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{=}%
\>[246I]\AgdaInductiveConstructor{≤-limiting}%
\>[20]\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[246I]%
\>[8]\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax-≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.fun}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
%
\>[6]\AgdaKeyword{where}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{nindMax-≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[8]\AgdaFunction{nindMax-≤}\AgdaSpace{}%
\AgdaInductiveConstructor{ℕ.zero}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{≤-Z}\<%
\\
%
\>[8]\AgdaFunction{nindMax-≤}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{=}%
\>[280I]\AgdaFunction{indMax-monoL}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax-≤}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[280I]%
\>[12]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaBound{lt}\<%
\end{code}

      An immediate corollary of this is that $\maxInf\ (\maxInf\ t)$ is equivalent to $\maxInf\ t$.
\begin{code}[hide]%
\>[0]\<%
\\
%
\>[4]\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{≤-cocone}%
\>[31]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.inv}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.rightInv}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{≤-refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-mono}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{extLim}%
\>[30]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Iso.fun}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{where}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{nindMax-mono}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[8]\AgdaFunction{nindMax-mono}\AgdaSpace{}%
\AgdaInductiveConstructor{ℕ.zero}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{≤-Z}\<%
\\
%
\>[8]\AgdaFunction{nindMax-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nindMax-mono}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-idem∞}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-idem∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-idem}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaComment{--Convenient\ helper\ for\ turning\ <\ with\ indMax∞\ into\ <\ without}\<%
\\
%
\>[4]\AgdaFunction{indMax<-∞}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<}}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax<-∞}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{≤∘<-in-<}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax-<Ls}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t1'}\AgdaSpace{}%
\AgdaBound{t2'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<}}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t1'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t2'}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaFunction{indMax-<Ls}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax-sucMono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t1'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t2'}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-≤L}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-≤L}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-<Ls}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t1'}\AgdaSpace{}%
\AgdaBound{t2'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<}}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t1'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t2'}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-<Ls}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[41]\AgdaFunction{<∘≤-in-<}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-<Ls}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2'}\AgdaSymbol{\})}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t1'}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t2'}\AgdaSymbol{)\}}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaInductiveConstructor{≤-sucMono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-monoL}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)))}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaInductiveConstructor{≤-sucMono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-monoL}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{))))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-lub}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}%
\>[63]\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-lub}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax∞-idem}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-absorbL}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-absorbL}\AgdaSpace{}%
\AgdaBound{lt12}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞-lub}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{lt12}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-distL}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-distL}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{indMax∞-lub}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-mono}\AgdaSpace{}%
\AgdaFunction{indMax-≤L}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax-≤R}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-distR}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-distR}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{≤-limiting}%
\>[42]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{Iso.fun}\AgdaSpace{}%
\AgdaBound{CℕIso}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{where}\<%
\\
%
\>[8]\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{ℕ.zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{≤-Z}\<%
\\
%
\>[8]\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{indMax-monoL}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nindMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{helper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\})}\<%
\\
%
\>[12]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax-swap4}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t2'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{indMax∞-lub}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{≤-refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{indMax∞-lub}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{≤-refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{indMax∞-cocone}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[24]\AgdaSymbol{\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{El}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaFunction{indMax∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Lim}%
\>[28]\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{indMax∞-cocone}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[26]\AgdaFunction{indMax∞-self}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤⨟}}\AgdaSpace{}%
\AgdaFunction{indMax∞-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{≤-cocone}%
\>[68]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{≤-refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\<%
\\
\>[0]\<%
\end{code}
